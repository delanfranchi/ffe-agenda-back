{
  "openapi": "3.0.0",
  "info": {
    "title": "FFE Chess Agenda API",
    "version": "1.0.0",
    "description": "API pour récupérer les informations sur les tournois d'échecs FFE",
    "contact": {
      "name": "Chess Agenda",
      "url": "https://github.com/chess-agenda"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3012",
      "description": "Serveur principal"
    }
  ],
  "components": {
    "schemas": {
      "Tournament": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Identifiant unique du tournoi",
            "example": "68608"
          },
          "name": {
            "type": "string",
            "description": "Nom du tournoi",
            "example": "Tournoi Vétérans + 55 ans N°4 2025 - 2026"
          },
          "date": {
            "type": "string",
            "format": "date",
            "description": "Date du tournoi au format ISO",
            "example": "2026-04-24T00:00:00.000Z"
          },
          "endDate": {
            "type": "string",
            "format": "date",
            "description": "Date de fin du tournoi (optionnel)",
            "example": "2026-04-26T00:00:00.000Z"
          },
          "location": {
            "type": "string",
            "description": "Ville du tournoi",
            "example": "TOURS"
          },
          "department": {
            "type": "integer",
            "description": "Numéro du département",
            "example": 37
          },
          "type": {
            "type": "string",
            "description": "Type de tournoi",
            "example": "CVL"
          },
          "status": {
            "type": "string",
            "enum": [
              "registration",
              "ongoing",
              "finished"
            ],
            "description": "Statut du tournoi",
            "example": "registration"
          },
          "maxPlayers": {
            "type": "integer",
            "description": "Nombre maximum de joueurs",
            "example": 64
          },
          "currentPlayers": {
            "type": "integer",
            "description": "Nombre actuel de joueurs inscrits",
            "example": 32
          },
          "registrationDeadline": {
            "type": "string",
            "format": "date",
            "description": "Date limite d'inscription",
            "example": "2026-04-10T00:00:00.000Z"
          },
          "url": {
            "type": "string",
            "format": "uri",
            "description": "URL vers la fiche du tournoi sur le site FFE",
            "example": "https://www.echecs.asso.fr/FicheTournoi.aspx?Ref=68608"
          },
          "players": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Player"
            },
            "description": "Liste des joueurs inscrits (optionnel)"
          }
        },
        "required": [
          "id",
          "name",
          "date",
          "location",
          "department",
          "type",
          "status",
          "url"
        ]
      },
      "Player": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Identifiant unique du joueur",
            "example": "jean-dupont"
          },
          "name": {
            "type": "string",
            "description": "Nom de famille du joueur",
            "example": "Dupont"
          },
          "firstName": {
            "type": "string",
            "description": "Prénom du joueur",
            "example": "Jean"
          },
          "club": {
            "type": "string",
            "description": "Club du joueur",
            "example": "Club d'Echecs de Tours"
          },
          "elo": {
            "type": "integer",
            "description": "Classement Elo du joueur",
            "example": 1650
          },
          "category": {
            "type": "string",
            "description": "Catégorie du joueur",
            "example": "A"
          },
          "isRegistered": {
            "type": "boolean",
            "description": "Indique si le joueur est inscrit au tournoi",
            "example": true
          }
        },
        "required": [
          "id",
          "name",
          "firstName",
          "club",
          "elo",
          "category",
          "isRegistered"
        ]
      },
      "ApiResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indique si la requête a réussi",
            "example": true
          },
          "data": {
            "type": "object",
            "description": "Données de la réponse (peut être null en cas d'erreur)"
          },
          "error": {
            "type": "string",
            "description": "Message d'erreur (présent uniquement si success=false)",
            "example": "Tournament not found"
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp de la dernière mise à jour des données",
            "example": "2025-09-20T08:04:23.941Z"
          }
        },
        "required": [
          "success",
          "data",
          "lastUpdated"
        ]
      },
      "TournamentListResponse": {
        "type": "object",
        "properties": {
          "tournaments": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Tournament"
            },
            "description": "Liste des tournois"
          },
          "total": {
            "type": "integer",
            "description": "Nombre total de tournois trouvés",
            "example": 25
          },
          "department": {
            "type": "integer",
            "description": "Département recherché (0 si multiple départements)",
            "example": 37
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp de la dernière mise à jour",
            "example": "2025-09-20T08:04:23.941Z"
          }
        },
        "required": [
          "tournaments",
          "total",
          "department",
          "lastUpdated"
        ]
      },
      "TournamentDetailsResponse": {
        "type": "object",
        "properties": {
          "tournament": {
            "$ref": "#/components/schemas/Tournament"
          },
          "players": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Player"
            },
            "description": "Liste des joueurs inscrits au tournoi"
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp de la dernière mise à jour",
            "example": "2025-09-20T08:04:23.941Z"
          }
        },
        "required": [
          "tournament",
          "players",
          "lastUpdated"
        ]
      },
      "Error": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": false
          },
          "error": {
            "type": "string",
            "description": "Message d'erreur détaillé",
            "example": "Invalid department parameter"
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp de l'erreur",
            "example": "2025-09-20T08:04:23.941Z"
          }
        },
        "required": [
          "success",
          "error",
          "lastUpdated"
        ]
      }
    },
    "parameters": {
      "Department": {
        "name": "department",
        "in": "query",
        "description": "Numéro du département",
        "required": true,
        "schema": {
          "type": "integer",
          "example": 37
        }
      },
      "DepartmentArray": {
        "name": "department[]",
        "in": "query",
        "description": "Numéros des départements (peut être répété)",
        "required": true,
        "schema": {
          "type": "array",
          "items": {
            "type": "integer"
          },
          "example": [
            37,
            41
          ]
        }
      },
      "TournamentId": {
        "name": "id",
        "in": "path",
        "description": "Identifiant unique du tournoi",
        "required": true,
        "schema": {
          "type": "string",
          "example": "68608"
        }
      },
      "Limit": {
        "name": "limit",
        "in": "query",
        "description": "Nombre maximum de résultats à retourner",
        "required": false,
        "schema": {
          "type": "integer",
          "minimum": 1,
          "maximum": 100,
          "default": 50,
          "example": 10
        }
      },
      "Offset": {
        "name": "offset",
        "in": "query",
        "description": "Nombre de résultats à ignorer (pour la pagination)",
        "required": false,
        "schema": {
          "type": "integer",
          "minimum": 0,
          "default": 0,
          "example": 0
        }
      },
      "Next": {
        "name": "next",
        "in": "query",
        "description": "Filtrer pour ne retourner que les événements à venir",
        "required": false,
        "schema": {
          "type": "boolean",
          "default": false,
          "example": true
        }
      },
      "Club": {
        "name": "club",
        "in": "query",
        "description": "Nom du club pour filtrer les tournois",
        "required": false,
        "schema": {
          "type": "string",
          "example": "Club de Tours"
        }
      },
      "ShowOnlyClub": {
        "name": "showOnlyClub",
        "in": "query",
        "description": "Afficher seulement les tournois où des joueurs du club sont inscrits",
        "required": false,
        "schema": {
          "type": "boolean",
          "default": false,
          "example": true
        }
      }
    }
  },
  "paths": {
    "/api/agenda": {
      "get": {
        "summary": "Récupère la liste des tournois d'échecs",
        "description": "Retourne la liste des tournois d'échecs pour les départements spécifiés, avec possibilité de filtrage par club et événements futurs",
        "tags": [
          "Agenda"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/DepartmentArray"
          },
          {
            "$ref": "#/components/parameters/Limit"
          },
          {
            "$ref": "#/components/parameters/Club"
          },
          {
            "$ref": "#/components/parameters/ShowOnlyClub"
          },
          {
            "$ref": "#/components/parameters/Next"
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des tournois récupérée avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/Tournament"
                          }
                        }
                      }
                    }
                  ]
                },
                "example": {
                  "success": true,
                  "data": [
                    {
                      "id": "68608",
                      "name": "Tournoi Vétérans + 55 ans N°4 2025 - 2026",
                      "date": "2026-04-24T00:00:00.000Z",
                      "location": "TOURS",
                      "department": 37,
                      "type": "CVL",
                      "status": "registration",
                      "url": "https://www.echecs.asso.fr/FicheTournoi.aspx?Ref=68608"
                    }
                  ],
                  "lastUpdated": "2025-09-20T08:04:23.941Z"
                }
              }
            }
          },
          "400": {
            "description": "Paramètres de requête invalides",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "error": "department[] parameter is required",
                  "lastUpdated": "2025-09-20T08:04:23.941Z"
                }
              }
            }
          },
          "500": {
            "description": "Erreur interne du serveur",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "error": "Internal server error",
                  "lastUpdated": "2025-09-20T08:04:23.941Z"
                }
              }
            }
          }
        }
      }
    },
    "/api/tournaments/{id}/players": {
      "get": {
        "summary": "Récupère la liste des joueurs d'un tournoi",
        "description": "Retourne la liste des joueurs inscrits à un tournoi d'échecs spécifique",
        "tags": [
          "Players"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/TournamentId"
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des joueurs récupérée avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/Player"
                          }
                        }
                      }
                    }
                  ]
                },
                "example": {
                  "success": true,
                  "data": [
                    {
                      "id": "jean-dupont",
                      "name": "Dupont",
                      "firstName": "Jean",
                      "club": "Club d'Echecs de Paris",
                      "elo": 1650,
                      "category": "A",
                      "isRegistered": true
                    },
                    {
                      "id": "marie-martin",
                      "name": "Martin",
                      "firstName": "Marie",
                      "club": "Club d'Echecs de Lyon",
                      "elo": 1420,
                      "category": "B",
                      "isRegistered": true
                    }
                  ],
                  "lastUpdated": "2024-03-01T10:30:00.000Z"
                }
              }
            }
          },
          "400": {
            "description": "ID de tournoi manquant ou invalide",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "error": "Tournament ID is required",
                  "lastUpdated": "2024-03-01T10:30:00.000Z"
                }
              }
            }
          },
          "500": {
            "description": "Erreur interne du serveur",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "error": "Internal server error",
                  "lastUpdated": "2024-03-01T10:30:00.000Z"
                }
              }
            }
          }
        }
      }
    },
    "/api/tournaments/{id}": {
      "get": {
        "summary": "Récupère les détails d'un tournoi spécifique",
        "description": "Retourne les informations détaillées d'un tournoi d'échecs, y compris la liste des joueurs inscrits",
        "tags": [
          "Tournaments"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/TournamentId"
          }
        ],
        "responses": {
          "200": {
            "description": "Détails du tournoi récupérés avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/TournamentDetailsResponse"
                        }
                      }
                    }
                  ]
                },
                "example": {
                  "success": true,
                  "data": {
                    "tournament": {
                      "id": "68608",
                      "name": "Tournoi Vétérans + 55 ans N°4 2025 - 2026",
                      "date": "2026-04-24T00:00:00.000Z",
                      "endDate": "2026-04-26T00:00:00.000Z",
                      "location": "TOURS",
                      "department": 37,
                      "type": "CVL",
                      "status": "registration",
                      "maxPlayers": 64,
                      "currentPlayers": 32,
                      "url": "https://www.echecs.asso.fr/FicheTournoi.aspx?Ref=68608"
                    },
                    "players": [
                      {
                        "id": "jean-dupont",
                        "name": "Dupont",
                        "firstName": "Jean",
                        "club": "Club d'Echecs de Tours",
                        "elo": 1650,
                        "category": "A",
                        "isRegistered": true
                      }
                    ],
                    "lastUpdated": "2025-09-20T08:04:23.941Z"
                  },
                  "lastUpdated": "2025-09-20T08:04:23.941Z"
                }
              }
            }
          },
          "400": {
            "description": "ID de tournoi manquant ou invalide",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "error": "Tournament ID is required",
                  "lastUpdated": "2025-09-20T08:04:23.941Z"
                }
              }
            }
          },
          "500": {
            "description": "Erreur interne du serveur",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "error": "Internal server error",
                  "lastUpdated": "2025-09-20T08:04:23.941Z"
                }
              }
            }
          }
        }
      }
    },
    "/api/tournaments": {
      "get": {
        "summary": "Récupère la liste des tournois d'échecs avec pagination",
        "description": "Retourne la liste des tournois d'échecs pour les départements spécifiés, avec support de la pagination et filtrage par événements futurs",
        "tags": [
          "Tournaments"
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/Department"
          },
          {
            "$ref": "#/components/parameters/DepartmentArray"
          },
          {
            "$ref": "#/components/parameters/Limit"
          },
          {
            "$ref": "#/components/parameters/Offset"
          },
          {
            "$ref": "#/components/parameters/Next"
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des tournois récupérée avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "allOf": [
                    {
                      "$ref": "#/components/schemas/ApiResponse"
                    },
                    {
                      "type": "object",
                      "properties": {
                        "data": {
                          "$ref": "#/components/schemas/TournamentListResponse"
                        }
                      }
                    }
                  ]
                },
                "example": {
                  "success": true,
                  "data": {
                    "tournaments": [
                      {
                        "id": "68608",
                        "name": "Tournoi Vétérans + 55 ans N°4 2025 - 2026",
                        "date": "2026-04-24T00:00:00.000Z",
                        "location": "TOURS",
                        "department": 37,
                        "type": "CVL",
                        "status": "registration",
                        "url": "https://www.echecs.asso.fr/FicheTournoi.aspx?Ref=68608"
                      }
                    ],
                    "total": 25,
                    "department": 37,
                    "lastUpdated": "2025-09-20T08:04:23.941Z"
                  },
                  "lastUpdated": "2024-03-01T10:30:00.000Z"
                }
              }
            }
          },
          "400": {
            "description": "Paramètres de requête invalides",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "error": "Department parameter is required",
                  "lastUpdated": "2025-09-20T08:04:23.941Z"
                }
              }
            }
          },
          "500": {
            "description": "Erreur interne du serveur",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                },
                "example": {
                  "success": false,
                  "error": "Internal server error",
                  "lastUpdated": "2025-09-20T08:04:23.941Z"
                }
              }
            }
          }
        }
      }
    }
  },
  "tags": []
}